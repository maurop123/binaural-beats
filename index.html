<html>
  <head>
    <script>
      //Channel 1
      const channel1 = new (window.AudioContext || window.webkitAudioContent) ();

      //Channel 2
      const channel2 = new (window.AudioContext || window.webkitAudioContent) ();

      //Tone 1
      const osc1 = channel1.createOscillator() //default frequency is 440HZ

      //Tone 2
      const osc2 = channel2.createOscillator()
      osc2.frequency.value = 435

      //Channel 1 Left Stereo
      const leftStereo = new StereoPannerNode(channel1)
      leftStereo.pan.value = -1 // -1 left side, 0 balanced, 1 right side

      //Channel 2 right Stereo
      const rightStereo = new StereoPannerNode(channel2, { pan: 1}) //shortcut: set pan in creation options

      //Plug the 1st tone into left stereo, and then out channel 1
      osc1.connect(leftStereo).connect(channel1.destination)

      //Plug the 2nd tone into right stereo, and then out channel 2
      osc2.connect(rightStereo).connect(channel2.destination)

      //Start tones
      osc1.start()
      osc2.start()


      //FUNCTIONS

      //Resume
      function resume() {
        channel1.resume()
        channel2.resume()
      }

      //Pause
      function pause() {
        channel1.suspend()
        channel2.suspend()
      }

      //Update left stereo (channel 1's tone)
      function updateLeftStereo() {
        const val = document.getElementById("leftStereo").value
        osc1.frequency.value = val
      }

      //Update right stereo (channel 2's tone)
      function updateRightStereo() {
        const val = document.getElementById("rightStereo").value
        osc2.frequency.value = val
      }

      //Set time (seconds) to play beat for
      let time = 0  // default 0
      function setTime() {
        time = document.getElementById("timeInput").value
      }

      //Play beat for time
      function play() {
        if (time > 0) {
          resume()
          setTimeout(() => {
            pause()
          }, time * 1000)  // time in seconds
        }
        else {  // time = 0. so play curr beat till paused
          resume()
        }
      }
    </script>
  </head>
  <body>
    <player>
      <button onclick="play()">Play</button>
      <button onclick="resume()">Resume</button>
      <button onclick="pause()">Pause</button>
    </player>
    <form>
      <input id="leftStereo" type="number" value=440 onchange="updateLeftStereo()"/>
      <input id="rightStereo" type="number" value=435 onchange="updateRightStereo()"/>
      <input id="timeInput" type="number" value=0 onchange="setTime()"/>
    </form>
  </body>
</html>
